<?xml version='1.0' encoding='UTF-8' ?><addon id='Color_Panel'><metadata></metadata><model><property name='WorkWith' displayName='Works with (default: Drawing1)' type='string' isLocalized='false' isDefault='false'/><property name='Colors' displayName='Hex colors (new line separated)' type='text' isLocalized='false' isDefault='false'/><property name='HideTitleBars' displayName='Hide headers' type='boolean' isLocalized='false' isDefault='false'/><property name='ShowPanelOnly' displayName='Show panel only' type='boolean' isLocalized='false' isDefault='false'/><property name='ResetConnectedAddon' displayName='Reset connetced addon' type='boolean' isLocalized='false' isDefault='false'/></model><resources></resources><css>:root {
    --colors_panel_basic: #7cb342;
    --colors_panel_hover: #9ccc65;
    --colors_panel_text: #212121;
    --colors_panel_back: #f0f0f0;
    --colors_panel_border: #c8c8c8;
    --colors_panel_svg_hover: #ffffff;
    --colors_panel_outline: #0f0f0f;
    --colors_panel_value_back: #e0e0e0;
    --colors_panel_slider_back: #e0e0e0;
    --colors_panel_slider_back_hover: #d8d8d8;
    --colors_panel_radius_s: 4px;
    --colors_panel_radius_m: 8px;
    --colors_panel_transition: none;
}

.colors_panel {
    width: 100%;
    height: 100%;
    color: var(--colors_panel_text);
    text-align: center;
}

/* BUTTON */
.colors_panel_button {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 44px;
    height: 44px;
    position: absolute;
    border-radius: 50%;
    background-color: var(--colors_panel_basic);
    cursor: pointer;
}
.colors_panel_button:hover {
    background-color: var(--colors_panel_hover);
    transition: var(--colors_panel_transition);
}
.colors_panel_button.selected {
    background-color: var(--colors_panel_hover);
}
.colors_panel_button .image {
    width: 26px;
    height: 26px;
}
.colors_panel_button .image .active_area {
    fill: var(--colors_panel_svg_hover);
}

/* CONTAINER */
.colors_panel_container {
    width: 320px;
    top: -10px;
    left: 60px;
    background-color: var(--colors_panel_back);
    border: 1px solid var(--colors_panel_border);
    border-radius: var(--colors_panel_radius_m);
    cursor: move;
}
.colors_panel_title {
    height: 40px;
    padding: 10px 10px 5px;
    display: flex;
    justify-content: center;
    gap: var(--colors_panel_radius_s);
}
.colors_panel_wraper {
    height: auto;
}
.colors_panel_wraper .reset {
    position: absolute;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 44px;
    height: 44px;
    margin: 10px 0 10px 12px;
    border-radius: 50%;
    background-color: var(--colors_panel_basic);
    cursor: pointer;
}
.colors_panel_wraper .reset:hover {
    background-color: var(--colors_panel_hover);
    transition: var(--colors_panel_transition);
}
.colors_panel_wraper .reset .image {
    width: 26px;
    height: 26px;
    margin-top: -2px;
}
.colors_panel_wraper .reset .image .active_area {
    fill: var(--colors_panel_svg_hover);
}

.colors_panel_title .title_icon_colapse {
    width: 32px;
    height: 32px;
    padding: 2px;
    border-radius: var(--colors_panel_radius_s);
    cursor: pointer;
}
.colors_panel_title .title_icon_colapse:hover,
.colors_panel_title .title_icon_colapse.seleted {
    background-color: var(--colors_panel_basic);
}
.colors_panel_title .title_icon_colapse .image .active_area {
    fill: var(--colors_panel_basic);
}
.colors_panel_title .title_icon_colapse:hover .image .active_area {
    fill: var(--colors_panel_svg_hover);
}

.colors_panel_section {
    padding: 10px;
    border-top: 1px solid var(--colors_panel_border);
}

/* TOOL */
.colors_panel_tool {
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
}
.colors_panel_tool .tool {
    width: 50%;
    border-radius: var(--colors_panel_radius_s);
    outline: 2px solid var(--colors_panel_outline);
}

/* THICKNESS */
.wraper_thickness {
    display: flex;
    justify-content: center;
}
.icon_thickness {
    background-image: url(&quot;resources/../../../resources/5835527779909632.svg&quot;);
    background-repeat: no-repeat;
    width: 34px;
    height: 34px;
    margin-right: 10px;
}
.value_thickness {
    width: 50px;
    height: 34px;
    margin-left: 10px;
    border-radius: var(--colors_panel_radius_s);
    background-color: var(--colors_panel_value_back);
}
.slider_thickness {
    display: flex;
    align-items: center;
}
.slider_thickness .min,
.slider_thickness .max {
    margin: 0 10px;
}
.slider_thickness .slider {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 10px;
    border-radius: var(--colors_panel_radius_s);
    background-color: var(--colors_panel_slider_back);
    outline: none;
}
.slider_thickness .slider:hover {
    background-color: var(--colors_panel_slider_back_hover);
}
.slider_thickness .slider::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border: none;
    border-radius: 50%;
    background-color: var(--colors_panel_basic);
    cursor: pointer;
}
.slider_thickness .slider:hover::-moz-range-thumb {
    background-color: var(--colors_panel_hover);
}
.slider_thickness .slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    border: none;
    border-radius: 50%;
    background-color: var(--colors_panel_basic);
    cursor: pointer;
}
.slider_thickness .slider:hover::-webkit-slider-thumb {
    background-color: var(--colors_panel_hover);
}
.slider_thickness .slider:disabled::-webkit-slider-thumb,
.slider_thickness .slider:disabled::-moz-range-thumb {
    cursor: default;
}

/* TRANSPARENCY */
.wraper_transparency {
    display: flex;
    justify-content: center;
}
.icon_transparency {
    background-image: url(&quot;resources/../../../resources/serve/4588159419940864.svg&quot;);
    background-repeat: no-repeat;
    width: 34px;
    height: 34px;
    margin-right: 10px;
}
.value_transparency {
    width: 50px;
    height: 34px;
    margin-left: 10px;
    border-radius: var(--colors_panel_radius_s);
    background-color: var(--colors_panel_value_back);
}
.slider_transparency {
    display: flex;
    align-items: center;
}
.slider_transparency .min,
.slider_transparency .max {
    margin: 0 10px;
}
.slider_transparency .slider {
    -webkit-appearance: none;
    appearance: none;
    width: 100%;
    height: 10px;
    border-radius: var(--colors_panel_radius_s);
    background-color: var(--colors_panel_slider_back);
    outline: none;
}
.slider_transparency .slider:hover {
    background-color: var(--colors_panel_slider_back_hover);
}
.slider_transparency .slider::-moz-range-thumb {
    width: 24px;
    height: 24px;
    border: none;
    border-radius: 50%;
    background-color: var(--colors_panel_basic);
    cursor: pointer;
}
.slider_transparency .slider:hover::-moz-range-thumb {
    background-color: var(--colors_panel_hover);
}
.slider_transparency .slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px;
    height: 24px;
    border: none;
    border-radius: 50%;
    background-color: var(--colors_panel_basic);
    cursor: pointer;
}
.slider_transparency .slider:hover::-webkit-slider-thumb {
    background-color: var(--colors_panel_hover);
}
.slider_transparency .slider:disabled::-webkit-slider-thumb,
.slider_transparency .slider:disabled::-moz-range-thumb {
    cursor: default;
}

/* COLOR */
.wraper_color {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
}
.wraper_color .color {
    width: 30px;
    height: 30px;
    margin: 6px;
    border-radius: var(--colors_panel_radius_s);
    outline: 1px solid var(--colors_panel_border);
    cursor: pointer;
}
.wraper_color .eraser {
    display: flex;
    justify-content: center;
    align-items: center;
}
.wraper_color .eraser .image {
    width: 80%;
    height: 80%;
}
.wraper_color .color:hover {
    outline: 3px solid var(--colors_panel_outline);
    transition: var(--colors_panel_transition);
}
.wraper_color .selected {
    outline: 3px solid var(--colors_panel_outline);
}

/* DISABLED */
.icon_thickness.disabled,
.icon_transparency.disabled,
.colors_panel_tool .tool.disabled {
    opacity: 0.1 !important;
}
.title_thickness.disabled,
.value_thickness.disabled,
.slider_thickness .min.disabled,
.slider_thickness .max.disabled,
.slider_thickness .slider:disabled,
.slider_thickness .slider:disabled:hover {
    opacity: 0.3;
}
.slider_thickness .slider:disabled,
.slider_thickness .slider:disabled:hover {
    background-image: none;
}
.title_transparency.disabled,
.value_transparency.disabled,
.slider_transparency .min.disabled,
.slider_transparency .max.disabled,
.slider_transparency .slider:disabled,
.slider_transparency .slider:disabled:hover {
    opacity: 0.3;
}
.slider_transparency .slider:disabled,
.slider_transparency .slider:disabled:hover {
    background-image: none;
}

/* FONT */
.wraper_font {
    display: flex;
    justify-content: center;
    gap: 10px;
}
.wraper_font [class*=&quot;_font&quot;] {
    width: 44px;
    height: 44px;
    background-color: var(--colors_panel_basic);
    border-radius: 50%;
    margin: 10px 0;
    background-position: center bottom 3px;
    cursor: pointer;
}
.wraper_font .upload_image_font {
    background-image: url(&quot;resources/../../../resources/6063531711135744.svg&quot;);
}
.wraper_font .add_font {
    background-image: url(&quot;resources/../../../resources/5339291743551488.svg&quot;);
}
.wraper_font .decrease_font {
    background-image: url(&quot;resources/../../../resources/5482197083095040.svg&quot;);
}
.wraper_font .increase_font {
    background-image: url(&quot;resources/../../../resources/6616648840249344.svg&quot;);
}
.wraper_font .download_board_font {
    background-image: url(&quot;resources/../../../resources/5902241696972800.svg&quot;);
}
.wraper_font [class*=&quot;_font&quot;]:hover {
    background-color: var(--colors_panel_hover);
    transition: var(--colors_panel_transition);
}

/* ICON COLAPSE */
.colors_panel_container .title_bar {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: var(--colors_panel_radius_s);
    height: 40px;
}
.colors_panel_wraper .title_icon_colapse {
    padding: 2px;
    border-radius: var(--colors_panel_radius_s);
    cursor: pointer;
}
.colors_panel_wraper .title_icon_colapse:hover {
    background-color: var(--colors_panel_basic);
}
.colors_panel_wraper .title_icon_colapse .image {
    width: 32px;
    height: 32px;
}
.colors_panel_wraper .title_icon_colapse .image .active_area {
    fill: var(--colors_panel_basic);
}
.colors_panel_wraper .title_icon_colapse .image:hover {
    transition: var(--colors_panel_transition);
}
.colors_panel_wraper .title_icon_colapse .image:hover .active_area {
    fill: var(--colors_panel_svg_hover);
}
.colors_panel_wraper .title_icon_colapse.selected .image {
    transform: rotate(180deg);
    transition: var(--colors_panel_transition);
}</css><view>&lt;div class=&quot;colors_panel&quot;&gt;
    &lt;div class=&quot;colors_panel_button&quot;&gt;
        &lt;div class=&quot;image&quot;&gt;
            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-85 32-158t87.5-127q55.5-54 130-84.5T489-880q79 0 150 26.5T763.5-780q53.5 47 85 111.5T880-527q0 108-63 170.5T650-294h-75q-18 0-31 14t-13 31q0 27 14.5 46t14.5 44q0 38-21 58.5T480-80Zm0-400Zm-233 26q20 0 35-15t15-35q0-20-15-35t-35-15q-20 0-35 15t-15 35q0 20 15 35t35 15Zm126-170q20 0 35-15t15-35q0-20-15-35t-35-15q-20 0-35 15t-15 35q0 20 15 35t35 15Zm214 0q20 0 35-15t15-35q0-20-15-35t-35-15q-20 0-35 15t-15 35q0 20 15 35t35 15Zm131 170q20 0 35-15t15-35q0-20-15-35t-35-15q-20 0-35 15t-15 35q0 20 15 35t35 15ZM480-140q11 0 15.5-4.5T500-159q0-14-14.5-26T471-238q0-46 30-81t76-35h73q76 0 123-44.5T820-527q0-132-100-212.5T489-820q-146 0-247.5 98.5T140-480q0 141 99.5 240.5T480-140Z&quot;/&gt;&lt;/svg&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;colors_panel_container&quot;&gt;
        &lt;div class=&quot;colors_panel_title&quot;&gt;Color Definitions
            &lt;div class=&quot;title_icon_colapse&quot;&gt;
                &lt;div class=&quot;image&quot;&gt;
                    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-80 240-320l44-44 196 196 196-196 44 44L480-80ZM284-596l-44-44 240-240 240 240-44 44-196-196-196 196Z&quot;/&gt;&lt;/svg&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;colors_panel_wraper&quot;&gt;
            &lt;div class=&quot;reset&quot;&gt;
                &lt;div class=&quot;image&quot;&gt;
                    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#fff&quot; d=&quot;M451-122q-123-10-207-101t-84-216q0-77 35.5-145T295-695l43 43q-56 33-87 90.5T220-439q0 100 66 173t165 84v60Zm60 0v-60q100-12 165-84.5T741-439q0-109-75.5-184.5T481-699h-20l60 60-43 43-133-133 133-133 43 43-60 60h20q134 0 227 93.5T801-439q0 125-83.5 216T511-122Z&quot;/&gt;&lt;/svg&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_tool&quot;&gt;
                &lt;div class=&quot;tool&quot;&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_thickness&quot;&gt;
                &lt;div class=&quot;title_bar&quot;&gt;
                    &lt;div class=&quot;title_thickness&quot;&gt;Thickness: 10&lt;/div&gt;
                    &lt;div id=&quot;title1&quot; class=&quot;title_icon_colapse&quot;&gt;
                        &lt;div class=&quot;image&quot;&gt;
                            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z&quot;/&gt;&lt;/svg&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;wraper_thickness&quot;&gt;
                    &lt;div class=&quot;icon_thickness&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;slider_thickness&quot;&gt;
                        &lt;div class=&quot;min&quot;&gt;2&lt;/div&gt;
                        &lt;input type=&quot;range&quot; min=&quot;2&quot; max=&quot;20&quot; value=&quot;10&quot; step=&quot;2&quot; class=&quot;slider&quot;&gt;
                        &lt;div class=&quot;max&quot;&gt;20&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;value_thickness&quot;&gt;10&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_transparency&quot;&gt;
                &lt;div class=&quot;title_bar&quot;&gt;
                    &lt;div class=&quot;title_transparency&quot;&gt;Opacity: 1.0&lt;/div&gt;
                    &lt;div id=&quot;title2&quot; class=&quot;title_icon_colapse&quot;&gt;
                        &lt;div class=&quot;image&quot;&gt;
                            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z&quot;/&gt;&lt;/svg&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;wraper_transparency&quot;&gt;
                    &lt;div class=&quot;icon_transparency&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;slider_transparency&quot;&gt;
                        &lt;div class=&quot;min&quot;&gt;0.1&lt;/div&gt;
                        &lt;input type=&quot;range&quot; min=&quot;0.1&quot; max=&quot;1&quot; value=&quot;1&quot; step=&quot;0.1&quot; class=&quot;slider&quot;&gt;
                        &lt;div class=&quot;max&quot;&gt;1&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;value_transparency&quot;&gt;1&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_color&quot;&gt;
                &lt;div class=&quot;title_bar&quot;&gt;
                    &lt;div class=&quot;title_color&quot;&gt;Color&lt;/div&gt;
                    &lt;div id=&quot;title3&quot; class=&quot;title_icon_colapse&quot;&gt;
                        &lt;div class=&quot;image&quot;&gt;
                            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z&quot;/&gt;&lt;/svg&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;wraper_color&quot;&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_font&quot;&gt;
                &lt;div class=&quot;title_bar&quot;&gt;
                    &lt;div class=&quot;title_font&quot;&gt;Font&lt;/div&gt;
                    &lt;div id=&quot;title4&quot; class=&quot;title_icon_colapse&quot;&gt;
                        &lt;div class=&quot;image&quot;&gt;
                            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z&quot;/&gt;&lt;/svg&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;wraper_font&quot;&gt;
                    &lt;div class=&quot;upload_image_font&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;add_font&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;decrease_font&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;increase_font&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;download_board_font&quot;&gt;&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;</view><preview>&lt;div class=&quot;colors_panel&quot;&gt;
    &lt;div class=&quot;colors_panel_button&quot;&gt;
        &lt;div class=&quot;image&quot;&gt;
            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-80q-82 0-155-31.5t-127.5-86Q143-252 111.5-325T80-480q0-85 32-158t87.5-127q55.5-54 130-84.5T489-880q79 0 150 26.5T763.5-780q53.5 47 85 111.5T880-527q0 108-63 170.5T650-294h-75q-18 0-31 14t-13 31q0 27 14.5 46t14.5 44q0 38-21 58.5T480-80Zm0-400Zm-233 26q20 0 35-15t15-35q0-20-15-35t-35-15q-20 0-35 15t-15 35q0 20 15 35t35 15Zm126-170q20 0 35-15t15-35q0-20-15-35t-35-15q-20 0-35 15t-15 35q0 20 15 35t35 15Zm214 0q20 0 35-15t15-35q0-20-15-35t-35-15q-20 0-35 15t-15 35q0 20 15 35t35 15Zm131 170q20 0 35-15t15-35q0-20-15-35t-35-15q-20 0-35 15t-15 35q0 20 15 35t35 15ZM480-140q11 0 15.5-4.5T500-159q0-14-14.5-26T471-238q0-46 30-81t76-35h73q76 0 123-44.5T820-527q0-132-100-212.5T489-820q-146 0-247.5 98.5T140-480q0 141 99.5 240.5T480-140Z&quot;/&gt;&lt;/svg&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;colors_panel_container&quot;&gt;
        &lt;div class=&quot;colors_panel_title&quot;&gt;Color Definitions
            &lt;div class=&quot;title_icon_colapse&quot;&gt;
                &lt;div class=&quot;image&quot;&gt;
                    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-80 240-320l44-44 196 196 196-196 44 44L480-80ZM284-596l-44-44 240-240 240 240-44 44-196-196-196 196Z&quot;/&gt;&lt;/svg&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;colors_panel_wraper&quot;&gt;
            &lt;div class=&quot;reset&quot;&gt;
                &lt;div class=&quot;image&quot;&gt;
                    &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#fff&quot; d=&quot;M451-122q-123-10-207-101t-84-216q0-77 35.5-145T295-695l43 43q-56 33-87 90.5T220-439q0 100 66 173t165 84v60Zm60 0v-60q100-12 165-84.5T741-439q0-109-75.5-184.5T481-699h-20l60 60-43 43-133-133 133-133 43 43-60 60h20q134 0 227 93.5T801-439q0 125-83.5 216T511-122Z&quot;/&gt;&lt;/svg&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_tool&quot;&gt;
                &lt;div class=&quot;tool&quot;&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_thickness&quot;&gt;
                &lt;div class=&quot;title_bar&quot;&gt;
                    &lt;div class=&quot;title_thickness&quot;&gt;Thickness: 10&lt;/div&gt;
                    &lt;div id=&quot;title1&quot; class=&quot;title_icon_colapse&quot;&gt;
                        &lt;div class=&quot;image&quot;&gt;
                            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z&quot;/&gt;&lt;/svg&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;wraper_thickness&quot;&gt;
                    &lt;div class=&quot;icon_thickness&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;slider_thickness&quot;&gt;
                        &lt;div class=&quot;min&quot;&gt;2&lt;/div&gt;
                        &lt;input type=&quot;range&quot; min=&quot;2&quot; max=&quot;20&quot; value=&quot;10&quot; step=&quot;2&quot; class=&quot;slider&quot;&gt;
                        &lt;div class=&quot;max&quot;&gt;20&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;value_thickness&quot;&gt;10&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_transparency&quot;&gt;
                &lt;div class=&quot;title_bar&quot;&gt;
                    &lt;div class=&quot;title_transparency&quot;&gt;Opacity: 1.0&lt;/div&gt;
                    &lt;div id=&quot;title2&quot; class=&quot;title_icon_colapse&quot;&gt;
                        &lt;div class=&quot;image&quot;&gt;
                            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z&quot;/&gt;&lt;/svg&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;wraper_transparency&quot;&gt;
                    &lt;div class=&quot;icon_transparency&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;slider_transparency&quot;&gt;
                        &lt;div class=&quot;min&quot;&gt;0.1&lt;/div&gt;
                        &lt;input type=&quot;range&quot; min=&quot;0.1&quot; max=&quot;1&quot; value=&quot;1&quot; step=&quot;0.1&quot; class=&quot;slider&quot;&gt;
                        &lt;div class=&quot;max&quot;&gt;1&lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;value_transparency&quot;&gt;1&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_color&quot;&gt;
                &lt;div class=&quot;title_bar&quot;&gt;
                    &lt;div class=&quot;title_color&quot;&gt;Color&lt;/div&gt;
                    &lt;div id=&quot;title3&quot; class=&quot;title_icon_colapse&quot;&gt;
                        &lt;div class=&quot;image&quot;&gt;
                            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z&quot;/&gt;&lt;/svg&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;wraper_color&quot;&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;colors_panel_section colors_panel_font&quot;&gt;
                &lt;div class=&quot;title_bar&quot;&gt;
                    &lt;div class=&quot;title_font&quot;&gt;Font&lt;/div&gt;
                    &lt;div id=&quot;title4&quot; class=&quot;title_icon_colapse&quot;&gt;
                        &lt;div class=&quot;image&quot;&gt;
                            &lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-345 240-585l43-43 197 198 197-197 43 43-240 239Z&quot;/&gt;&lt;/svg&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;wraper_font&quot;&gt;
                    &lt;div class=&quot;upload_image_font&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;add_font&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;decrease_font&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;increase_font&quot;&gt;&lt;/div&gt;
                    &lt;div class=&quot;download_board_font&quot;&gt;&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;</preview><presenter>function AddonColor_Panel_create(){

    let presenter = function () { };

    presenter.setPlayerController = function (controller) {
        presenter.playerController = controller;
    };

    presenter.run = function (view, model) {
        console.log(&apos;Color Panel v1.1&apos;);
        presenter.initiate(view, model, true);
    };

    presenter.createPreview = function (view, model) {
        presenter.initiate(view, model, false);
    };

    presenter.initiate = (view, model, isPreview) =&gt; {
        presenter.view = view;
        presenter.$view = $(view);
        presenter.isVisibleByDefault = ModelValidationUtils.validateBoolean(model[&apos;Is Visible&apos;]);
        presenter.isVisible = presenter.isVisibleByDefault;
        presenter.setVisibility(presenter.isVisibleByDefault || !isPreview);
        presenter.isPanelVisible = false;

        presenter.workWidth = model.WorkWith ? model.WorkWith : &apos;Drawing1&apos;;
        presenter.fontFamily = window.getComputedStyle(document.documentElement).getPropertyValue(&apos;--font-primary&apos;).replace(/&apos;|&quot;/gi, &apos;&apos;).trim();
        if (!presenter.fontFamily) presenter.fontFamily = &apos;Arial&apos;;

        presenter.thickness = 10;
        presenter.opacity = 1;
        presenter.currentColorId = &apos;color1&apos;;
        presenter.fontSize = 30;
        presenter.colapseIcons = [false, false, false, false, false];
        presenter.hideTitleBars = ModelValidationUtils.validateBoolean(model.HideTitleBars);
        presenter.showPanelOnly = ModelValidationUtils.validateBoolean(model.ShowPanelOnly);
        presenter.resetConnectedAddon = ModelValidationUtils.validateBoolean(model.ResetConnectedAddon);

        presenter.setPanel(model, isPreview);
    };

    presenter.setVisibility = isVisible =&gt; {
        presenter.$view.css(&apos;visibility&apos;, isVisible ? &apos;visible&apos; : &apos;hidden&apos;);
        presenter.isVisible = isVisible;
    };

    presenter.executeCommand = function (name, params) {
        let commands = {
            &apos;show&apos;: presenter.show,
            &apos;hide&apos;: presenter.hide
        };
        Commands.dispatch(commands, name, params[0], presenter);
    };

    presenter.show = function () {
        presenter.setVisibility(true);
    };

    presenter.hide = function () {
        presenter.setVisibility(false);
    };

    presenter.setPanel = function (model, isPreview) {
        $(&apos;.colors_panel_container&apos;).draggable();

        presenter.setThicknessPanel(isPreview);
        presenter.setTransparencyPanel(isPreview);
        presenter.setColorPalette(model, isPreview);
        presenter.setFont(isPreview);
        presenter.setColapseIcons(isPreview);
        presenter.setHideTitleBars(isPreview);
        presenter.setShowPanelOnly(isPreview);

        let button = presenter.view.querySelector(&apos;.colors_panel_button&apos;);
        button.onclick = presenter.showPanelHandler;
        button.ontouchend = presenter.showPanelHandler;

        let reset = presenter.view.querySelector(&apos;.colors_panel_wraper .reset&apos;);
        reset.onclick = presenter.handleReset;
        reset.ontouchend = presenter.handleReset;
    };

    presenter.setThicknessPanel = function (isPreview) {
        presenter.setThickness();

        let sliderThick = presenter.view.querySelector(&apos;.slider_thickness .slider&apos;);
        let titleThick = presenter.view.querySelector(&apos;.title_thickness&apos;);
        let valueThick = presenter.view.querySelector(&apos;.value_thickness&apos;);
        sliderThick.oninput = function () {
            titleThick.innerHTML = `Thickness: ${this.value}`;
            valueThick.innerHTML = `${this.value}`;
            presenter.thickness = this.value;
            presenter.setVisualization(isPreview);
        }
    };
    presenter.setThickness = function () {
        let sliderThick = presenter.view.querySelector(&apos;.slider_thickness .slider&apos;);
        let titleThick = presenter.view.querySelector(&apos;.title_thickness&apos;);
        let valueThick = presenter.view.querySelector(&apos;.value_thickness&apos;);
        sliderThick.value = presenter.thickness;
        titleThick.innerHTML = `Thickness: ${presenter.thickness}`;
        valueThick.innerHTML = presenter.thickness;
    };

    presenter.setTransparencyPanel = function (isPreview) {
        presenter.setTransparency();

        let sliderTrans = presenter.view.querySelector(&apos;.slider_transparency .slider&apos;);
        let titleTrans = presenter.view.querySelector(&apos;.title_transparency&apos;);
        let valueTrans = presenter.view.querySelector(&apos;.value_transparency&apos;);
        sliderTrans.oninput = function () {
            titleTrans.innerHTML = `Opacity: ${this.value}`;
            valueTrans.innerHTML = `${this.value}`;
            presenter.opacity = this.value;
            presenter.setVisualization(isPreview);
        }
    };
    presenter.setTransparency = function () {
        let sliderTrans = presenter.view.querySelector(&apos;.slider_transparency .slider&apos;);
        let titleTrans = presenter.view.querySelector(&apos;.title_transparency&apos;);
        let valueTrans = presenter.view.querySelector(&apos;.value_transparency&apos;);
        sliderTrans.value = presenter.opacity;
        titleTrans.innerHTML = `Opacity: ${presenter.opacity}`;
        valueTrans.innerHTML = presenter.opacity;
    };

    presenter.setFont = function (isPreview) {
        if (!isPreview) return;

        let uploadImage = presenter.view.querySelector(&apos;.upload_image_font&apos;);
        let addFont = presenter.view.querySelector(&apos;.add_font&apos;);
        let decreaseFont = presenter.view.querySelector(&apos;.decrease_font&apos;);
        let increaseFont = presenter.view.querySelector(&apos;.increase_font&apos;);
        let downloadBoard = presenter.view.querySelector(&apos;.download_board_font&apos;);
        let modul = presenter.playerController.getModule(presenter.workWidth);

        uploadImage.onclick = handleUploadImage;
        uploadImage.ontouchend = handleUploadImage;

        addFont.onclick = handleAddFont;
        addFont.ontouchend = handleAddFont;

        decreaseFont.onclick = handleDecreaseFont;
        decreaseFont.ontouchend = handleDecreaseFont;

        increaseFont.onclick = handleIncreaseFont;
        increaseFont.ontouchend = handleIncreaseFont;

        downloadBoard.onclick = handleDownloadBoard;
        downloadBoard.ontouchend = handleDownloadBoard;
console.log(`${presenter.fontSize}px &quot;${presenter.fontFamily}&quot;`);
        function handleUploadImage(e) {
            modul.uploadImage();
        }
        function handleAddFont(e) {
            modul.setFont(`${presenter.fontSize}px &quot;${presenter.fontFamily}&quot;`);
            modul.addText();
        }
        function handleDecreaseFont(e) {
            presenter.fontSize -= 10;
            presenter.fontSize = presenter.fontSize &gt;= 10 ? presenter.fontSize : 10;
            modul.setFont(`${presenter.fontSize}px &quot;${presenter.fontFamily}&quot;`);
        }
        function handleIncreaseFont(e) {
            presenter.fontSize += 10;
            presenter.fontSize = presenter.fontSize &lt;= 100 ? presenter.fontSize : 100;
            modul.setFont(`${presenter.fontSize}px &quot;${presenter.fontFamily}&quot;`);
        }
        function handleDownloadBoard(e) {
            modul.downloadBoard();
        }
    };

    presenter.setColapseIcons = function (isPreview) {
        let colapseIcons = presenter.view.querySelectorAll(&apos;.colors_panel_wraper .title_icon_colapse .image&apos;);
        colapseIcons.forEach((icon) =&gt; {
            icon.onclick = handleColapse;
            icon.ontouchend = handleColapse;
        });
        function handleColapse(e) {
            let titleBar = e.target.closest(&apos;.title_bar&apos;);
            let titleIcon = e.target.closest(&apos;.title_icon_colapse&apos;);
            let idx = parseInt(titleIcon.id.slice(5), 10);
            presenter.colapseIcons[idx] = !presenter.colapseIcons[idx];
            let wraperToColapse = titleBar.nextElementSibling;
            $(wraperToColapse).toggle();
            $(titleIcon).toggleClass(&apos;selected&apos;);
        }

        let colapseIAllcons = presenter.view.querySelector(&apos;.colors_panel_title .title_icon_colapse .image&apos;);
        colapseIAllcons.onclick = handleColapseAll;
        colapseIAllcons.ontouchend = handleColapseAll;
        function handleColapseAll(e) {
            let elementSelected = e.target.closest(&apos;.title_icon_colapse&apos;);
            presenter.colapseIcons[0] = !presenter.colapseIcons[0];
            $(elementSelected).toggleClass(&apos;selected&apos;);

            let isElementSeleted = $(elementSelected).hasClass(&apos;selected&apos;);
            let imageSelected = e.target.closest(&apos;.image&apos;);
            if (isElementSeleted) {
                imageSelected.innerHTML = `&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;m290-85-42-42 232-232 232 232-42 42-190-190L290-85Zm190-517L248-834l42-42 190 190 190-190 42 42-232 232Z&quot;/&gt;&lt;/svg&gt;`;
            } else {
                imageSelected.innerHTML = `&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-80 240-320l44-44 196 196 196-196 44 44L480-80ZM284-596l-44-44 240-240 240 240-44 44-196-196-196 196Z&quot;/&gt;&lt;/svg&gt;`;
            }

            colapseIcons.forEach((icon, idx) =&gt; {
                let titleBar = icon.closest(&apos;.title_bar&apos;);
                let wraperToColapse = titleBar.nextElementSibling;
                let iconToColapse = icon.closest(&apos;.title_icon_colapse&apos;);
                if (isElementSeleted) {
                    $(wraperToColapse).hide();
                    $(iconToColapse).addClass(&apos;selected&apos;);
                    presenter.colapseIcons[idx + 1] = true;
                } else {
                    $(wraperToColapse).show();
                    $(iconToColapse).removeClass(&apos;selected&apos;);
                    presenter.colapseIcons[idx + 1] = false;
                }
            });
        }
    };

    presenter.setHideTitleBars = function (isPreview) {
        if (presenter.hideTitleBars) {
            let titleBars = presenter.view.querySelectorAll(&apos;.colors_panel_container .title_bar&apos;);
            titleBars.forEach((bar) =&gt; $(bar).hide());
            let titleIcon = presenter.view.querySelector(&apos;.colors_panel_title .title_icon_colapse&apos;);
            $(titleIcon).hide();
            let sections = presenter.view.querySelectorAll(&apos;.colors_panel_section&apos;);
            sections.forEach((section) =&gt; $(section).css({&apos;border-top&apos;: &apos;none&apos;}));
        }
    };

    presenter.setShowPanelOnly = function (isPreview) {
        if (presenter.showPanelOnly) {
            let colorsPanelButton = presenter.view.querySelector(&apos;.colors_panel_button&apos;);
            $(colorsPanelButton).hide();
            let colorsPanelContainer = presenter.view.querySelector(&apos;.colors_panel_container&apos;);
            $(colorsPanelContainer).show();
        } else {
            if (isPreview) $(&apos;.colors_panel_container&apos;).toggle();
        }
    };

    presenter.setColorPalette = function (model, isPreview) {
        let dafaultColors = &apos;#9e9e9e\n#212121\n#ffffff\n#f71c46\n#ff71d9\n#be4ad1\n#875dd1\n#5252d8\n#227af2\n#5fc7ff\n#32d1d8\n#15afa9\n#00c309\n#96e041\n#ced92b\n#fde635\n#ff9d0d\n#ff7600\n#be7054\n#83381d&apos;;
        let modelColors = model.Colors;
        if (!modelColors) modelColors = dafaultColors;
        modelColors += &apos;\neraser&apos;;

        let colors = modelColors.split(&apos;\n&apos;);
        let wraperColor = presenter.view.querySelector(&apos;.wraper_color&apos;);

        colors.forEach((color, idx) =&gt; {
            let div = document.createElement(&apos;div&apos;);
            div.id = `color${idx + 1}`;
            div.className = `color color${idx + 1}`;
            div.style.backgroundColor = color;
            if (!idx) $(div).addClass(&apos;selected&apos;);
            if (idx == colors.length - 1) {
                div.id = &apos;eraser&apos;;
                $(div).addClass(&apos;eraser&apos;);
                let innerDiv = document.createElement(&apos;div&apos;);
                innerDiv.className = &apos;image&apos;;
                $(innerDiv).append(`&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M678-220h203v60H618l60-60Zm-499 60-81-84q-18-17-17.5-41.5T97-327l458-498q16-17 40.567-17 24.566 0 41.433 17l205 215q17 17 18 42t-16 42L503-160H179Zm301-60 324-352-207-217-455 503 64 66h274Zm0-260Z&quot;/&gt;&lt;/svg&gt;`);
                div.appendChild(innerDiv);
            }
            wraperColor.appendChild(div);

            // add color from CSS
            const compBackColor = window.getComputedStyle(div).getPropertyValue(&apos;background-color&apos;);
            div.style.backgroundColor = compBackColor;

            div.onclick = presenter.handleToggleColor;
            div.ontouchend = presenter.handleToggleColor;
        });

        let firstChildBackColor = wraperColor.firstChild.style.backgroundColor;
        presenter.color = presenter.rgb2Hex(firstChildBackColor);

        presenter.setVisualization(isPreview);
    };

    presenter.handleToggleColor = function (e) {
        e.preventDefault();
        e.stopPropagation();
        presenter.currentColorId = e.target.id ? e.target.id : &apos;eraser&apos;;    // click on &lt;svg&gt; in eraser
        presenter.toggleColor();
    };

    presenter.rgb2Hex = (s) =&gt; s.match(/[0-9]+/g).reduce((a, b) =&gt; a + (b | 256).toString(16).slice(1), &apos;#&apos;);

    presenter.toggleColor = function () {
        let wraperColor = presenter.view.querySelector(&apos;.wraper_color&apos;);
        let colorDiv = Array.from(wraperColor.children);
        colorDiv.forEach((div, idx) =&gt; {
            $(div).removeClass(&apos;selected&apos;);
            if (div.id == presenter.currentColorId) {
                $(div).addClass(&apos;selected&apos;);
                if (!$(div).hasClass(&apos;eraser&apos;)) {
                    presenter.color = presenter.rgb2Hex(div.style.backgroundColor);
                }
            }
        });

        presenter.setVisualization(true);
    };

    presenter.setVisualization = function (isPreview) {
        let isEraser = $(&apos;.wraper_color .eraser&apos;).hasClass(&apos;selected&apos;);

        // set slider bigger range for eraser
        let sliderTick = presenter.view.querySelector(&apos;.slider_thickness .slider&apos;);
        let sliderTickMax = presenter.view.querySelector(&apos;.slider_thickness .max&apos;);
        if (isEraser) {
            sliderTick.max = 40;
            sliderTickMax.innerText = 40;
        } else {
            if (parseInt(sliderTick.value, 10) &gt; 20) {
                let titleTick = presenter.view.querySelector(&apos;.title_thickness&apos;);
                let valueTick = presenter.view.querySelector(&apos;.value_thickness&apos;);
                sliderTick.value = 20;
                titleTick.innerText = &apos;Thickness: 20&apos;;
                valueTick.innerText = &apos;20&apos;;
                presenter.thickness = 20;
            }
            sliderTick.max = 20;
            sliderTickMax.innerText = 20;
        }

        $(&apos;.colors_panel_tool .tool&apos;).css({
            &apos;height&apos;: `${presenter.thickness}px`,
            &apos;opacity&apos;: presenter.opacity,
            &apos;background-color&apos;: isEraser ? &apos;transparent&apos; : presenter.color
        });

        let sliderTrans = presenter.view.querySelector(&apos;.slider_transparency .slider&apos;);
        if (isEraser) {
            sliderTrans.setAttribute(&apos;disabled&apos;, true);
            $(&apos;.colors_panel_wraper .tool&apos;).addClass(&apos;disabled&apos;);
            $(&apos;.slider_transparency .min, .slider_transparency .max&apos;).addClass(&apos;disabled&apos;);
            $(&apos;.colors_panel_wraper .title_transparency&apos;).addClass(&apos;disabled&apos;);
            $(&apos;.colors_panel_wraper .value_transparency&apos;).addClass(&apos;disabled&apos;);
            $(&apos;.colors_panel_wraper .icon_transparency&apos;).addClass(&apos;disabled&apos;);
        } else {
            sliderTrans.removeAttribute(&apos;disabled&apos;);
            $(&apos;.colors_panel_wraper .tool&apos;).removeClass(&apos;disabled&apos;);
            $(&apos;.slider_transparency .min, .slider_transparency .max&apos;).removeClass(&apos;disabled&apos;);
            $(&apos;.colors_panel_wraper .title_transparency&apos;).removeClass(&apos;disabled&apos;);
            $(&apos;.colors_panel_wraper .value_transparency&apos;).removeClass(&apos;disabled&apos;);
            $(&apos;.colors_panel_wraper .icon_transparency&apos;).removeClass(&apos;disabled&apos;);
        }

        if (isPreview) {
            tool = presenter.playerController.getModule(presenter.workWidth);
            if (tool) {
                if (!isEraser) {
                    tool.setColor(presenter.color);
                    tool.setThickness(presenter.thickness);
                    tool.setOpacity(presenter.opacity);
                } else {
                    tool.setEraserThickness(presenter.thickness);
                    tool.setEraserOn();
                }
            }
        }
    };

    presenter.showPanelHandler = function (e) {
        e.preventDefault();
        e.stopPropagation();

        $(&apos;.colors_panel_button&apos;).toggleClass(&apos;selected&apos;);
        $(&apos;.colors_panel_container&apos;).toggle();
        presenter.isPanelVisible = !presenter.isPanelVisible;
    };

    presenter.setShowErrorsMode = function () { };

    presenter.setWorkMode = function () { };

    presenter.showAnswers = function () { };

    presenter.hideAnswers = function () { };

    presenter.reset = function () {
        // presenter.playerController.getCommands().hideNavigationPanels();
        presenter.setVisibility(presenter.isVisibleByDefault);
        presenter.isPanelVisible = false;
        $(&apos;.colors_panel_button&apos;).removeClass(&apos;selected&apos;);
        $(&apos;.colors_panel_container&apos;).hide();

        presenter.handleReset();
    };

    presenter.handleReset = function () {
        presenter.thickness = 10;
        presenter.opacity = 1;
        presenter.currentColorId = &apos;color1&apos;;
        presenter.colapseIcons = [false, false, false, false, false];

        presenter.setThickness();
        presenter.setTransparency();
        presenter.toggleColor();
        presenter.handleColapseIcons();
        presenter.setShowPanelOnly();

        if (presenter.resetConnectedAddon) {
            let modul = presenter.playerController.getModule(presenter.workWidth);
            if (modul) {
                modul.reset();
                presenter.setVisualization(true);
            }
        }
    };

    presenter.handleColapseIcons = function () {
        let colapseIcons = presenter.view.querySelectorAll(&apos;.title_icon_colapse&apos;);
        colapseIcons.forEach((icon, idx) =&gt; {
            if (idx) {
                let titleBar = icon.closest(&apos;.title_bar&apos;);
                let wraperToColapse = titleBar.nextElementSibling;
                if (presenter.colapseIcons[idx]) {
                    $(wraperToColapse).hide();
                    $(icon).addClass(&apos;selected&apos;);
                } else {
                    $(wraperToColapse).show();
                    $(icon).removeClass(&apos;selected&apos;);
                }
            } else {
                if (presenter.colapseIcons[idx]) {
                    $(icon).addClass(&apos;selected&apos;);
                    icon.querySelector(&apos;.image&apos;).innerHTML = `&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;m290-85-42-42 232-232 232 232-42 42-190-190L290-85Zm190-517L248-834l42-42 190 190 190-190 42 42-232 232Z&quot;/&gt;&lt;/svg&gt;`;
                } else {
                    $(icon).removeClass(&apos;selected&apos;);
                    icon.querySelector(&apos;.image&apos;).innerHTML = `&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 -960 960 960&quot;&gt;&lt;path class=&quot;active_area&quot; fill=&quot;#000&quot; d=&quot;M480-80 240-320l44-44 196 196 196-196 44 44L480-80ZM284-596l-44-44 240-240 240 240-44 44-196-196-196 196Z&quot;/&gt;&lt;/svg&gt;`;
                }
            }
        });
    };

    presenter.getState = function () {
        return JSON.stringify({
            isVisible: presenter.isVisible,
            isPanelVisible: presenter.isPanelVisible,
            thickness: presenter.thickness,
            opacity: presenter.opacity,
            color: presenter.color,
            currentColorId: presenter.currentColorId,
            fontSize: presenter.fontSize,
            colapseIcons: presenter.colapseIcons
        });
    };

    presenter.setState = function (state) {
        let parsedState = JSON.parse(state);

        presenter.isVisible = parsedState.isVisible;
        presenter.setVisibility(presenter.isVisible);

        presenter.isPanelVisible = parsedState.isPanelVisible;
        if (presenter.isPanelVisible) {
            $(&apos;.colors_panel_button&apos;).addClass(&apos;selected&apos;);
            $(&apos;.colors_panel_container&apos;).show();
        }

        presenter.fontSize = parsedState.fontSize;
        presenter.thickness = parsedState.thickness;
        presenter.opacity = parsedState.opacity;
        presenter.color = parsedState.color;
        presenter.currentColorId = parsedState.currentColorId;
        if (presenter.currentColorId == &apos;eraser&apos;) {
            presenter.currentColorId = &apos;color1&apos;;
            if (parseInt(presenter.thickness, 10) &gt; 20) presenter.thickness = &apos;20&apos;;
        }

        presenter.setThickness();
        presenter.setTransparency();
        presenter.toggleColor();
        presenter.setFont(true);

        presenter.colapseIcons = parsedState.colapseIcons;
        presenter.handleColapseIcons();
    };

    return presenter;
}</presenter></addon>